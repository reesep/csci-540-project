
import subprocess
import os

def test_for_rainbow_vulnerability():

    file = open("../Data/user.csv")
    header = file.readline()
    i = header.strip().split(",").index("password")
    
    for each in file:
        h = each.split(",")
        out = subprocess.Popen(["rainbow/./rcrack", ".", "-h",h[i]],stdout=subprocess.PIPE)
        output, error = out.communicate()
        print(error.decode("utf-8"))
        print(output.decode("utf-8"))

                    

    
    
    


if __name__ == "__main__":
    test_for_rainbow_vulnerability()
