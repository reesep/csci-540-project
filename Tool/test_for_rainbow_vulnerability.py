
import subprocess
import os
import re

def test(the_list,name):
    print("--- Testing for Rainbow Table Vulnerability ---")
    count = 0
    cracked = []
    for each in the_list:

        if os.name == 'nt':
            out = str(subprocess.run("cd rainbow && rcrack.exe . -h " + str(each), capture_output=True,shell=True))
        else:  ## NEED TO TEST THIS ON SUSANS
            #out = str(subprocess.run("cd rainbow && ./rcrack.exe . -h " + str(each), capture_output=True, shell=True))
            print("skipping over rainbow table testing...")
            return
        try:
            out = out.replace(r'\r\n',"")
            found = re.search(r'result----------------------------------------------------------------(.+?)hex', out).group(1)
        except AttributeError:
            # AAA, ZZZ not found in the original string
            found = ''  # apply your error handling

        if "<not found>" not in found:
            count += 1
            cracked.append(found)

    if cracked == []:
        print("Rainbow table was not able to crack any " + name + "(s)")
    else:
        x = 1
        print("Rainbow table was able to crack",str(count) + " " + name +"(s)")
        print(name + "s Cracked")
        print("-----------------")
        for each in cracked:
            print(str(x) + "." + each)
            x += 1

    print()


if __name__ == "__main__":
    test()
